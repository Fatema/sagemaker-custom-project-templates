# Advanced topics

## Test the created templates as normal cloudformation templates
***NOTE:** make sure to run `cdk synth` before running any of the commands defined below.*

You will need to deploy the `service catalog stack` as that would setup your account with the required resources and ssm parameters before you can start testing your templates directly. If you don't have the service catalog stack already deployed in your account, you can achieve this by running the following command:
```
cdk --app ./cdk.out/assembly-Personal deploy â€”all --profile mlops-dev
```

otherwise make sure you have these ssm parameters defined:
- in the dev account:
  - /mlops/dev/account_id
  - /mlops/code/seed_bucket
  - /mlops/code/build
  - /mlops/code/build/byoc
  - /mlops/code/deploy
- in the preprod account:
  - /mlops/preprod/account_id
  - /mlops/preprod/region
- in the prod account:
  - /mlops/prod/account_id
  - /mlops/prod/region

For quick testing of the sagemaker templates, you could deploy the json generated by CDK directly in your account by running the following command:
```
aws cloudformation deploy \
	--template-file ./cdk.out/byoc-project-stack-dev.template.json \
	--stack-name byoc-project-stack-dev \
	--region eu-west-1 \
	--capabilities CAPABILITY_NAMED_IAM CAPABILITY_AUTO_EXPAND \
	--disable-rollback \
  --s3-bucket <any s3 bucket in the account, preferred cdk bootstrap bucket> \
  --profile mlops-dev \
	--parameter-overrides \
	  SageMakerProjectName=mlops-test-0 \
	  SageMakerProjectId=sm12340
```
This command will deploy the byoc project stack if you want to deploy other templates just change the `--template-file`, if you want to create a new stack you can change the other fields as well. 

It is also possible to use CDK command for this exact purpose but this would require you to add the following to `app.py` file:
```
from mlops_sm_project_template.templates.byoc_project_stack import MLOpsStack

MLOpsStack(
    app,
    "test",
     env=deployment_env,
)
```
The run `cdk synth` and then run the following to deploy:
```
cdk deploy test --parameters SageMakerProjectName=mlops-test \
    --parameters SageMakerProjectId=sm1234 --profile mlops-dev
```